/ip firewall mangle
add action=mark-connection chain=prerouting comment="ICMP Traffic" \
    new-connection-mark=ICMP_Traffic passthrough=yes protocol=icmp
add action=mark-packet chain=prerouting connection-mark=ICMP_Traffic \
    new-packet-mark=ICMP passthrough=no
add action=mark-connection chain=prerouting comment="HTTP & HTTPS Traffic" \
    dst-port=80,8080,443 new-connection-mark=HTTP_HTTPS_Traffic passthrough=yes \
    protocol=tcp
add action=mark-packet chain=prerouting connection-mark=HTTP_HTTPS_Traffic \
    new-packet-mark=HTTP_HTTPS passthrough=no
add action=mark-connection chain=prerouting comment="DNS Traffic" dst-port=53 \
    new-connection-mark=DNS_Traffic passthrough=yes protocol=udp
add action=mark-packet chain=prerouting connection-mark=DNS_Traffic \
    new-packet-mark=DNS passthrough=no
add action=mark-connection chain=prerouting comment="DHCP Server" dst-port=67 \
    new-connection-mark=DHCP_Server_Traffic passthrough=yes protocol=udp
add action=mark-packet chain=prerouting connection-mark=DHCP_Server_Traffic \
    new-packet-mark=DHCP_Server passthrough=no
add action=mark-connection chain=prerouting comment="SMTP Traffic" dst-port=\
    110,995,143,993,25,465,587 new-connection-mark=SMTP_Traffic passthrough=yes \
    protocol=tcp
add action=mark-packet chain=prerouting connection-mark=SMTP_Traffic \
    new-packet-mark=SMTP passthrough=no
add action=mark-connection chain=prerouting comment="PPTP VPN" dst-port=1723 \
    new-connection-mark=PPTP_Traffic passthrough=yes protocol=tcp
add action=mark-packet chain=prerouting connection-mark=PPTP_Traffic \
    new-packet-mark=PPTP passthrough=no
add action=mark-connection chain=prerouting comment="L2TP VPN" dst-port=\
    500,4500,1701 new-connection-mark=L2TP_Traffic passthrough=yes protocol=udp
add action=mark-packet chain=prerouting connection-mark=L2TP_Traffic \
    new-packet-mark=L2TP passthrough=no
add action=mark-connection chain=prerouting comment="OpenVPN Traffic" dst-port=\
    1194 new-connection-mark=OpenVPN_Traffic passthrough=yes protocol=udp
add action=mark-packet chain=prerouting connection-mark=OpenVPN_Traffic \
    new-packet-mark=OpenVPN passthrough=no
add action=mark-connection chain=prerouting comment="VOIP Traffic" dst-port=\
    5060,5061,1000-2000 new-connection-mark=VOIP_Traffic passthrough=yes \
    protocol=tcp
add action=mark-packet chain=prerouting connection-mark=VOIP_Traffic \
    new-packet-mark=VOIP passthrough=no
add action=mark-connection chain=prerouting comment="FTP Traffic" dst-port=\
    20,21 new-connection-mark=FTP_Traffic passthrough=yes protocol=tcp
add action=mark-packet chain=prerouting connection-mark=FTP_Traffic \
    new-packet-mark=FTP passthrough=no
add action=mark-connection chain=prerouting comment="SSH Traffic" dst-port=22 \
    new-connection-mark=SSH_Traffic passthrough=yes protocol=tcp
add action=mark-packet chain=prerouting connection-mark=SSH_Traffic \
    new-packet-mark=SSH passthrough=no
add action=mark-connection chain=prerouting comment=Other new-connection-mark=\
    Other passthrough=yes
add action=mark-packet chain=prerouting connection-mark=Other new-packet-mark=\
    OtherC passthrough=no
add action=mark-packet chain=forward comment="HogarB\E1sico Download" \
    dst-address-list="HogarB\E1sico" new-packet-mark="HogarB\E1sico_Download" \
    passthrough=no
add action=mark-packet chain=forward comment="HogarB\E1sico Upload" \
    new-packet-mark="HogarB\E1sico_Upload" passthrough=no src-address-list=\
    "HogarB\E1sico"
add action=mark-packet chain=forward comment="Hogar Intermedio Download" \
    dst-address-list=HogarIntermedio new-packet-mark=HogarIntermedio_Download \
    passthrough=no
add action=mark-packet chain=forward comment="HogarIntermedio Upload" \
    new-packet-mark=HogarIntermedio_Upload passthrough=no src-address-list=\
    HogarIntermedio
add action=mark-packet chain=forward comment="HogarPlus Download" \
    dst-address-list=HogarPlus new-packet-mark=HogarPlus_Download passthrough=\
    no
add action=mark-packet chain=forward comment="HogarPlus Upload" \
    new-packet-mark=HogarPlus_Upload passthrough=no src-address-list=HogarPlus
add action=mark-packet chain=forward comment="HogarAvanzado Download" \
    dst-address-list=HogarAvanzado new-packet-mark=HogarAvanzado_Download \
    passthrough=no
add action=mark-packet chain=forward comment="HogarAvanzado Upload" \
    new-packet-mark=HogarAvanzado_Upload passthrough=no src-address-list=\
    HogarAvanzado
add action=mark-packet chain=forward comment="PymeB\E1sico Download" \
    dst-address-list="PymeB\E1sico" new-packet-mark="PymeB\E1sico_Download" \
    passthrough=no
add action=mark-packet chain=forward comment="PymeB\E1sico Upload" \
    new-packet-mark="PymeB\E1sico_Upload" passthrough=no src-address-list=\
    "PymeB\E1sico"
add action=mark-packet chain=forward comment="PymePlus Download" \
    dst-address-list=PymePlus new-packet-mark=PymePlus_Download passthrough=no
add action=mark-packet chain=forward comment="PymePlus Upload" new-packet-mark=\
    PymePlus_Upload passthrough=no src-address-list=PymePlus
add action=mark-packet chain=forward comment="PymeAvanzado Download" \
    dst-address-list=PymeAvanzado new-packet-mark=PymeAvanzado_Download \
    passthrough=no
add action=mark-packet chain=forward comment="PymeAvanzado Upload" \
    new-packet-mark=PymeAvanzado_Upload passthrough=no src-address-list=\
    PymeAvanzado
